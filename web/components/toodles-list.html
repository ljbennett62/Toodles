<link rel="import" href="/bower_components/polymer/polymer-element.html">
<link rel="import" href="/components/toodles-item.html">

<dom-module id="toodles-list">
  <template>
    <style>
      :host {
        bottom: 228px;
        display: none;
        left: 0;
        overflow: auto;
        padding: 16px 88px 0 16px;
        position: absolute;
        right: 0;
        top: 56px;
        transition-duration: 0.50s;  
        transition-property: opacity;                  
      }
    </style>
    <slot></slot>
  </template>
  <script>
    class List extends Polymer.Element {  
      static get is() { return 'toodles-list' }

      connectedCallback() {
        super.connectedCallback();
        this.addEventListener( 'click', evt => this.doListClick( evt ) );
      }

      static get properties() {
        return {
        	data: {
            type: Array,
            observer: 'onData'
          }
        }
      }

      hide() {
        TweenMax.to( this, 0.50, {
          opacity: 0,
          onComplete: function( element ) {
            element.style.display = 'none';
          },
          onCompleteParams: [this]
        } );
      }

      show() {
        this.style.display = 'block';
        this.style.opacity = 1;
      }      

      doItemOpen( evt ) {
        for( let i = 0; i < this.children.length; i++ ) {
          if( this.children[i] != evt.target ) {
            this.children[i].close();
          }
        }
      }

      doListClick( evt ) {
        if( evt.target == this ) {
          for( let i = 0; i < this.children.length; i++ ) {
            this.children[i].close();
          }
        }
      }

      onData( value, old ) {
        for( var i = 0; i < this.data.length; i++ ) {
          let item = document.createElement( 'toodles-item' );
          item.addEventListener( Item.OPEN, evt => this.doItemOpen( evt ) );
          item.task = value[i];
          this.appendChild( item );
        }
      }
    }

    customElements.define( List.is, List );    
  </script>
</dom-module>
